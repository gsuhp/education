<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Clinical Tools For Education</title>

<!-- jsPDF (UMD) -->
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<style>
  :root{--bg:#f7f8fb;--card:#fff;--muted:#6b7280;--accent:#1f2937}
  html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:#111}
  .wrap{max-width:980px;margin:18px auto;padding:18px;}
  .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px}
  .brand{font-size:20px;font-weight:700;color:var(--accent)}
  .nav{display:flex;gap:8px}
  .nav button{background:transparent;border:1px solid transparent;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
  .nav button.active{background:var(--accent);color:#fff}
  .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 8px 20px rgba(15,23,42,0.06);border:1px solid #e6eef8}
  label{display:block;margin-top:12px;font-weight:700}
  input[type="text"], input[type="number"], input[type="date"], select, textarea {
    width:100%; padding:10px; margin-top:6px; border-radius:8px; border:1px solid #d1d5db; box-sizing:border-box; font-weight:700;
  }
  textarea{min-height:80px; resize:vertical}
  .row{display:flex;gap:12px}
  .col-1{flex:0 0 120px}
  .col-flex{flex:1}
  .small{font-size:12px;color:var(--muted);margin-left:6px;font-weight:400}
  .controls{display:flex;gap:8px;margin-top:12px}
  button.primary{background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:700}
  button.ghost{background:transparent;border:1px solid #d1d5db;padding:10px 14px;border-radius:8px;cursor:pointer}
  .logout{background:#b33;color:#fff;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
  pre#output{background:#fafafa;padding:12px;border-radius:8px;border:1px solid #eee;margin-top:14px;white-space:pre-wrap}
  .login-wrap, .disclaimer-wrap{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.35);z-index:999}
  .login-card, .disclaimer-card{width:360px;background:var(--card);padding:20px;border-radius:12px;box-shadow:0 12px 40px rgba(2,6,23,0.2)}
  .login-card h2,.disclaimer-card h2{text-align:center;margin:0 0 12px;font-size:18px}
  .meta{font-size:12px;color:var(--muted);text-align:center;margin-top:8px}
  @media (max-width:760px){ .row{flex-direction:column} .col-1{flex:auto} }
  a.linkish{color:var(--accent);text-decoration:underline;cursor:pointer;font-weight:700}
</style>
</head>
<body>

<!-- DISCLAIMER -->
<div id="disclaimer" class="disclaimer-wrap" aria-hidden="false">
  <div class="disclaimer-card" role="dialog" aria-label="Disclaimer">
    <h2>Disclaimer — Educational Use Only</h2>
    <p style="margin:8px 0 12px">This site is for educational / roleplay purposes only. Do not enter real patient-identifiable information (PHI). No data is sent to any server — authentication and storage are client-side only.</p>
    <div style="display:flex;gap:8px">
      <button id="acceptDisclaimer" class="primary" style="flex:1">I Understand — Continue</button>
    </div>
  </div>
</div>

<!-- LOGIN -->
<div id="login" class="login-wrap" aria-hidden="true" style="display:none">
  <div class="login-card" role="dialog" aria-label="Site login">
    <h2>Protected Access</h2>
    <label for="loginUser">Username</label>
    <input id="loginUser" type="text" autocomplete="username" placeholder="Enter username">
    <label for="loginPass" style="margin-top:10px">Password</label>
    <input id="loginPass" type="password" autocomplete="current-password" placeholder="Enter password">
    <div style="display:flex;gap:8px;margin-top:12px;">
      <button id="loginBtn" class="primary" style="flex:1">Sign in</button>
    </div>
    <div style="display:flex;justify-content:space-between;margin-top:10px;align-items:center">
      <div class="meta">Client-side authentication only.</div>
      <a id="forgotLink" class="linkish" aria-label="Forgot password">Forgot?</a>
    </div>
  </div>
</div>

<!-- APP -->
<div id="app" class="wrap" style="display:none">
  <div class="topbar">
    <div class="brand">Clinical Tools For Education</div>
    <div style="display:flex;align-items:center;gap:12px">
      <div class="nav" role="navigation" aria-label="Form switch">
        <button id="btnGAD" class="active">GAD-7</button>
        <button id="btnPHQ">PHQ-A</button>
        <button id="btnDoctor">Doctor's Note</button>
        <button id="btnHospital">Hospital Visit</button>
      </div>
      <button id="logout" class="logout">Log out</button>
    </div>
  </div>

  <!-- GAD -->
  <div id="gadCard" class="card" aria-hidden="false">
    <h3>GAD-7 Note Builder</h3>
    <label>Patient Name:</label>
    <input type="text" id="gad_patientName" placeholder="Enter patient name">
    <div class="row" style="margin-top:6px">
      <div class="col-1">
        <label>Age:</label>
        <input type="number" id="gad_age" min="0" max="120" placeholder="Age">
      </div>
      <div class="col-flex">
        <label>Date:</label>
        <input type="date" id="gad_date">
      </div>
    </div>
    <label>GAD-7 Score:</label>
    <input type="number" id="gad_score" min="0" max="21" placeholder="0–21">
    <label>Severity: <span class="small">(auto-updates from score — override okay)</span></label>
    <select id="gad_severity">
      <option value="Minimal/None">Minimal/None (0–4)</option>
      <option value="Mild">Mild (5–9)</option>
      <option value="Moderate">Moderate (10–14)</option>
      <option value="Severe">Severe (15–21)</option>
    </select>
    <label>Provider (Name & Credentials):</label>
    <input type="text" id="gad_provider" placeholder="Enter provider name & credentials">
    <label>Patient Report:</label>
    <textarea id="gad_report" placeholder="Enter patient report..."></textarea>
    <label>Plan:</label>
    <textarea id="gad_plan" placeholder="Enter plan..."></textarea>
    <div class="controls" style="margin-top:12px">
      <button id="gad_generate" class="primary">Generate PDF</button>
      <button id="gad_preview" class="ghost">Preview Text</button>
    </div>
    <pre id="gad_output"></pre>
  </div>

  <!-- PHQ -->
  <div id="phqCard" class="card" style="margin-top:18px;display:none" aria-hidden="true">
    <h3>PHQ-A Note Builder</h3>
    <label>Patient Name:</label>
    <input type="text" id="phq_patientName" placeholder="Enter patient name">
    <div class="row" style="margin-top:6px">
      <div class="col-1">
        <label>Age:</label>
        <input type="number" id="phq_age" min="0" max="120" placeholder="Age">
      </div>
      <div class="col-flex">
        <label>Date:</label>
        <input type="date" id="phq_date">
      </div>
    </div>
    <label>PHQ-9-A Score:</label>
    <input type="number" id="phq_score" min="0" max="27" placeholder="0–27">
    <label>Severity: <span class="small">(auto-updates from score — override okay)</span></label>
    <select id="phq_severity">
      <option value="Minimal/None">Minimal/None (0–4)</option>
      <option value="Mild">Mild (5–9)</option>
      <option value="Moderate">Moderate (10–14)</option>
      <option value="Moderately Severe">Moderately Severe (15–19)</option>
      <option value="Severe">Severe (20–27)</option>
    </select>
    <label>Provider (Name & Credentials):</label>
    <input type="text" id="phq_provider" placeholder="Enter provider name & credentials">
    <label>Patient Report:</label>
    <textarea id="phq_report" placeholder="Enter patient report..."></textarea>
    <label>Plan:</label>
    <textarea id="phq_plan" placeholder="Enter plan..."></textarea>
    <div class="controls" style="margin-top:12px">
      <button id="phq_generate" class="primary">Generate PDF</button>
      <button id="phq_preview" class="ghost">Preview Text</button>
    </div>
    <pre id="phq_output"></pre>
  </div>

  <!-- Doctor Note -->
  <div id="doctorCard" class="card" style="margin-top:18px;display:none" aria-hidden="true">
    <h3>Doctor's Note Builder</h3>
    <label>Patient Name:</label>
    <input type="text" id="doc_patientName" placeholder="Enter patient name">
    <div class="row" style="margin-top:6px">
      <div class="col-1">
        <label>Age:</label>
        <input type="number" id="doc_age" min="0" max="120" placeholder="Age">
      </div>
      <div class="col-flex">
        <label>Date of Visit:</label>
        <input type="date" id="doc_date">
      </div>
    </div>
    <label>Provider (Name & Credentials):</label>
    <input type="text" id="doc_provider" placeholder="Enter provider name & credentials">
    <label>Illness / Diagnosis:</label>
    <input type="text" id="doc_illness" placeholder="Enter illness">
    <div class="row" style="margin-top:6px">
      <div class="col-1">
        <label>Start Date:</label>
        <input type="date" id="doc_start">
      </div>
      <div class="col-1">
        <label>End Date:</label>
        <input type="date" id="doc_end">
      </div>
      <div class="col-1">
        <label>Return Date:</label>
        <input type="date" id="doc_return">
      </div>
    </div>
    <div class="controls" style="margin-top:12px">
      <button id="doc_generate" class="primary">Generate PDF</button>
      <button id="doc_preview" class="ghost">Preview Text</button>
    </div>
    <pre id="doc_output"></pre>
  </div>

  <!-- Hospital Visit -->
  <div id="hospitalCard" class="card" style="margin-top:18px;display:none" aria-hidden="true">
    <h3>Hospital Visit Summary</h3>
    <label>Name:</label><input type="text" id="hosp_name" placeholder="Patient Name">
    <label>DOB:</label><input type="date" id="hosp_dob">
    <label>Gender Identity:</label><input type="text" id="hosp_gender" placeholder="Gender Identity">
    <label>Scheduled Visits:</label><input type="text" id="hosp_scheduled">
    <label>Date of Last Physical:</label><input type="date" id="hosp_lastPhysical">
    <label>Visit Summary for Doctor:</label><input type="text" id="hosp_doctor">
    <label>Reason for Visit:</label><textarea id="hosp_reason"></textarea>

    <h4>Vitals</h4>
    <div class="row">
      <div class="col-1"><label>Height:</label><input type="text" id="hosp_height"></div>
      <div class="col-1"><label>Weight:</label><input type="text" id="hosp_weight"></div>
      <div class="col-1"><label>Temp:</label><input type="text" id="hosp_temp"></div>
    </div>
    <div class="row">
      <div class="col-1"><label>BP:</label><input type="text" id="hosp_bp"></div>
      <div class="col-1"><label>Pulse:</label><input type="text" id="hosp_pulse"></div>
      <div class="col-1"><label>Resp:</label><input type="text" id="hosp_resp"></div>
    </div>

    <h4>Labs</h4>
    <label>Status:</label><input type="text" id="hosp_labStatus" placeholder="Completed / Pending">
    <label>Result 1:</label><input type="text" id="hosp_labResult1"><label>Facility 1:</label><input type="text" id="hosp_labFacility1" value="Grey Sloan University Laboratory">
    <label>Result 2:</label><input type="text" id="hosp_labResult2"><label>Facility 2:</label><input type="text" id="hosp_labFacility2" value="Grey Sloan University Laboratory">

    <label>Diagnosis:</label><textarea id="hosp_diag">Based on the clinical evaluation and available investigations, the patient’s condition has been thoroughly assessed. Appropriate diagnosis has been made, and a management plan has been outlined accordingly.</textarea>
    <label>Plan:</label><textarea id="hosp_plan"></textarea>

    <div class="controls" style="margin-top:12px">
      <button id="hosp_preview" class="ghost">Preview Text</button>
      <button id="hosp_generate" class="primary">Generate PDF</button>
    </div>
    <pre id="hosp_output" style="margin-top:12px;"></pre>
  </div>

</div>

<script>
/* ---------- Accounts & Access ---------- */
const ACCOUNTS = {
  'nmccgsuh': { pw:'15358', provider: 'Dr. Nicolas McCarthy MD PhD FACS', access: {gad:true, phq:true, doc:true, hosp:true} },
  'mjohn':    { pw:'mj15358', provider: 'Dr. Martha Johnson DO', access: {gad:true, phq:true, doc:true, hosp:true} },
  'psych':    { pw:'psychgsuh', provider: null, access: {gad:true, phq:true, doc:false, hosp:false} },
  'doctor':   { pw:'doctor', provider: null, access: {gad:false, phq:false, doc:true, hosp:true} }
};
const FORGOT_CODE = 'gsuhdoctor';

/* ----- Elements ----- */
const disclaimer = document.getElementById('disclaimer');
const acceptDisclaimer = document.getElementById('acceptDisclaimer');
const loginWrap = document.getElementById('login');
const loginUser = document.getElementById('loginUser');
const loginPass = document.getElementById('loginPass');
const loginBtn = document.getElementById('loginBtn');
const forgotLink = document.getElementById('forgotLink');
const app = document.getElementById('app');
const logoutBtn = document.getElementById('logout');

const btnGAD = document.getElementById('btnGAD');
const btnPHQ = document.getElementById('btnPHQ');
const btnDoctor = document.getElementById('btnDoctor');
const btnHospital = document.getElementById('btnHospital');

const gadCard = document.getElementById('gadCard');
const phqCard = document.getElementById('phqCard');
const doctorCard = document.getElementById('doctorCard');
const hospitalCard = document.getElementById('hospitalCard');

/* ----- Tab switching ----- */
function hideAllCards(){ gadCard.style.display='none'; phqCard.style.display='none'; doctorCard.style.display='none'; hospitalCard.style.display='none'; }
function deactivateAllButtons(){ btnGAD.classList.remove('active'); btnPHQ.classList.remove('active'); btnDoctor.classList.remove('active'); btnHospital.classList.remove('active'); }

btnGAD.addEventListener('click', ()=>{ hideAllCards(); gadCard.style.display='block'; deactivateAllButtons(); btnGAD.classList.add('active'); });
btnPHQ.addEventListener('click', ()=>{ hideAllCards(); phqCard.style.display='block'; deactivateAllButtons(); btnPHQ.classList.add('active'); });
btnDoctor.addEventListener('click', ()=>{ hideAllCards(); doctorCard.style.display='block'; deactivateAllButtons(); btnDoctor.classList.add('active'); });
btnHospital.addEventListener('click', ()=>{ hideAllCards(); hospitalCard.style.display='block'; deactivateAllButtons(); btnHospital.classList.add('active'); });

/* ----- Disclaimer & Login ----- */
acceptDisclaimer.addEventListener('click', ()=>{
  disclaimer.style.display='none';
  loginWrap.style.display='flex';
});
forgotLink.addEventListener('click', ()=>{ alert(`Forgot code is: ${FORGOT_CODE}`); });
loginBtn.addEventListener('click', ()=>{
  const user = loginUser.value.trim();
  const pass = loginPass.value.trim();
  if(user in ACCOUNTS && ACCOUNTS[user].pw === pass){
    loginWrap.style.display='none';
    app.style.display='block';
    alert(`Welcome ${user}!`);
  } else { alert('Invalid username or password'); }
});
logoutBtn.addEventListener('click', ()=>{
  app.style.display='none';
  loginWrap.style.display='flex';
});

/* ---------- PDF/Preview Helpers ---------- */
function makePDF(title,text){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(12);
  doc.text(title,14,14);
  const split = doc.splitTextToSize(text,180);
  doc.text(split,14,22);
  doc.save(`${title.replace(/\s+/g,'_')}.pdf`);
}

/* ---------- Hospital Visit PDF/Preview ---------- */
function getHospitalNote(){
  return `
Hospital Visit Summary
====================
Name: ${document.getElementById('hosp_name').value || '[Name]'}
DOB: ${document.getElementById('hosp_dob').value || '[DOB]'}
Gender Identity: ${document.getElementById('hosp_gender').value || '[Gender]'}
Scheduled Visits: ${document.getElementById('hosp_scheduled').value || '[Scheduled Visits]'}
Date of Last Physical: ${document.getElementById('hosp_lastPhysical').value || '[Last Physical]'}
Visit Summary for Doctor: ${document.getElementById('hosp_doctor').value || '[Visit Summary]'}
Reason for Visit: ${document.getElementById('hosp_reason').value || '[Reason]'}

Vitals
------
Height: ${document.getElementById('hosp_height').value || '[Height]'}
Weight: ${document.getElementById('hosp_weight').value || '[Weight]'}
Temp: ${document.getElementById('hosp_temp').value || '[Temp]'}
BP: ${document.getElementById('hosp_bp').value || '[BP]'}
Pulse: ${document.getElementById('hosp_pulse').value || '[Pulse]'}
Resp: ${document.getElementById('hosp_resp').value || '[Resp]'}

Labs
----
Status: ${document.getElementById('hosp_labStatus').value || '[Status]'}
Result 1: ${document.getElementById('hosp_labResult1').value || '[Result1]'} | Facility: ${document.getElementById('hosp_labFacility1').value}
Result 2: ${document.getElementById('hosp_labResult2').value || '[Result2]'} | Facility: ${document.getElementById('hosp_labFacility2').value}

Diagnosis
---------
${document.getElementById('hosp_diag').value}

Plan
----
${document.getElementById('hosp_plan').value}
  `;
}

document.getElementById('hosp_preview').addEventListener('click', ()=>{
  document.getElementById('hosp_output').textContent = getHospitalNote();
});
document.getElementById('hosp_generate').addEventListener('click', ()=>{
  makePDF('Hospital Visit Summary',getHospitalNote());
});
</script>

</body>
</html>
